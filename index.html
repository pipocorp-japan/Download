<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>三菱トレインビジョン再現 (ピポラボ・デフォルト設定版)</title>
    <style>
        body {
            background-color: #f0f0f0;
            margin: 0;
            padding: 0;
            font-family: "Helvetica Neue", Helvetica, "Hiragino Kaku Gothic ProN", sans-serif;
            overflow: hidden;
            color: #333;
        }

        .monitor {
            width: 100vw;
            height: 56.25vw;
            max-width: 1280px;
            max-height: 720px;
            background-color: #fff;
            margin: 0 auto;
            position: relative;
            overflow: hidden;
        }

        /* 上部ヘッダー */
        .header-top {
            position: absolute;
            top: 40px;
            left: 60px;
            right: 60px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            z-index: 10;
        }

        .info-left {
            display: flex;
            align-items: center;
        }

        /* 種別 */
        .type-container-wrap {
            position: relative;
            width: 14vw;
            height: 4.5vw;
            margin-right: 20px;
        }

        .type-box {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: #0000ff;
            color: white;
            border-radius: 12px;
            font-size: 2.2vw;
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            transition: opacity 0.4s linear;
        }
        .type-box.active { opacity: 1; }

        /* 行先 */
        .dest-wrap {
            position: relative;
            height: 3.5vw;
            width: 30vw;
        }

        /* 号車表示エリア */
        .car-info-group {
            display: flex;
            align-items: center;
            font-size: 2.2vw;
            font-weight: bold;
        }

        .car-number-box {
            background-color: #888;
            color: white;
            width: 3.2vw;
            height: 3.2vw;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 6px;
            font-size: 2.5vw;
            margin: 0 10px;
        }

        .car-label-side {
            position: relative;
            height: 3.2vw;
            display: flex;
            align-items: center;
        }

        .label-before { width: 8vw; justify-content: flex-end; }
        .label-after { width: 6vw; justify-content: flex-start; }

        .fade-container {
            position: absolute;
            opacity: 0;
            transition: opacity 0.4s linear;
            white-space: nowrap;
        }
        .fade-container.active { opacity: 1; }

        /* メイン表示 */
        .main-display {
            position: absolute;
            top: 32%;
            width: 100%;
            height: 40%;
            display: flex;
            align-items: center;
            padding: 0 60px;
            box-sizing: border-box;
        }

        .fixed-elements {
            display: flex;
            align-items: center;
            height: 100%;
        }

        .label-wrap {
            position: relative;
            width: 10vw;
            height: 60px;
            font-size: 3.5vw;
            font-weight: bold;
        }

        .numbering-fixed {
            height: 9vw;
            width: 9vw;
            margin-left: 3vw;
            object-fit: contain;
            display: block;
        }

        .station-stage {
            flex: 1;
            height: 100%;
            margin-left: 4vw;
            perspective: 1000px;
        }

        .cube-text {
            width: 100%;
            height: 100%;
            position: relative;
            transform-style: preserve-3d;
            transition: transform 0.6s linear;
        }

        .face {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            display: flex;
            align-items: center;
            color: #333;
        }

        .face-jp { transform: rotateX(0deg) translateZ(80px); }
        .face-en { transform: rotateX(90deg) translateZ(80px); }
        .face-zh { transform: rotateX(180deg) translateZ(80px); }
        .face-ko { transform: rotateX(270deg) translateZ(80px); }

        .station-text { font-size: 9.8vw; font-weight: 900; letter-spacing: -2px; }

        /* 設定パネル */
        .settings-panel {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.95);
            z-index: 9999;
            color: white;
            padding: 20px;
            box-sizing: border-box;
            display: none;
            overflow-y: auto;
        }

        .setting-group { margin-bottom: 15px; border-bottom: 1px solid #333; padding-bottom: 10px; }
        .setting-group label { display: block; font-size: 11px; color: #aaa; margin-bottom: 5px; }
        .setting-group input { 
            width: 100%; padding: 10px; font-size: 14px; border-radius: 4px; border: none; margin-bottom: 5px; box-sizing: border-box;
        }

        .btn-row { display: flex; gap: 10px; margin-top: 15px; }
        .btn { flex: 1; padding: 12px; border: none; border-radius: 4px; font-weight: bold; cursor: pointer; }
        .btn-save { background: #0000ff; color: white; }
        .btn-close { background: #444; color: white; }

        .config-btn {
            position: fixed; bottom: 15px; right: 15px;
            width: 44px; height: 44px; background: rgba(0,0,0,0.05);
            color: #ccc; border: 1px solid #ddd; border-radius: 50%; z-index: 1000; font-size: 20px;
        }
    </style>
</head>
<body>

    <div class="monitor">
        <div class="header-top">
            <div class="info-left">
                <div class="type-container-wrap" id="type-container">
                    <div class="type-box active">各駅停車</div>
                    <div class="type-box">Local</div>
                    <div class="type-box">各站停车</div>
                    <div class="type-box">보통</div>
                </div>
                <div class="dest-wrap" id="dest-container">
                    <div class="fade-container active" id="d-dest-jp">西船橋 行き</div>
                    <div class="fade-container" id="d-dest-en">for Nishi-Funabashi</div>
                    <div class="fade-container" id="d-dest-zh">开往 西船桥</div>
                    <div class="fade-container" id="d-dest-ko">니시후나바시 行</div>
                </div>
            </div>

            <div class="car-info-group">
                <div class="car-label-side label-before" id="car-before-container">
                    <div class="fade-container"></div>
                    <div class="fade-container active">Car no.</div>
                    <div class="fade-container"></div>
                    <div class="fade-container"></div>
                </div>
                <div class="car-number-box" id="d-car-num">1</div>
                <div class="car-label-side label-after" id="car-after-container">
                    <div class="fade-container active">号車</div>
                    <div class="fade-container"></div>
                    <div class="fade-container">号车</div>
                    <div class="fade-container">호차</div>
                </div>
            </div>
        </div>

        <div class="main-display">
            <div class="fixed-elements">
                <div class="label-wrap" id="label-container">
                    <div class="fade-container active">次は</div>
                    <div class="fade-container">Next</div>
                    <div class="fade-container">下一站</div>
                    <div class="fade-container">다음은</div>
                </div>
                <img class="numbering-fixed" id="d-num-fixed" src="https://pipocorp-japan.github.io/asset/Newpipo.jpg">
            </div>

            <div class="station-stage">
                <div class="cube-text" id="cube">
                    <div class="face face-jp"><span class="station-text" id="d-jp">ピポラボ</span></div>
                    <div class="face face-en"><span class="station-text" id="d-en">pipoLab</span></div>
                    <div class="face face-zh"><span class="station-text" id="d-zh">皮波实验室</span></div>
                    <div class="face face-ko"><span class="station-text" id="d-ko">피포라 보라토리</span></div>
                </div>
            </div>
        </div>
    </div>

    <button class="config-btn" onclick="openCfg()">⚙</button>

    <div id="cfg-panel" class="settings-panel">
        <h3>トレインビジョン設定</h3>
        
        <div class="setting-group">
            <label>駅名 (JP / EN / ZH / KO)</label>
            <input type="text" id="i-jp" value="ピポラボ">
            <input type="text" id="i-en" value="pipoLab">
            <input type="text" id="i-zh" value="皮波实验室">
            <input type="text" id="i-ko" value="피포ラ 보라토리">
        </div>

        <div class="setting-group">
            <label>行先 (JP / EN / ZH / KO)</label>
            <input type="text" id="i-dest-jp" value="西船橋 行き">
            <input type="text" id="i-dest-en" value="for Nishi-Funabashi">
            <input type="text" id="i-dest-zh" value="开往 西船桥">
            <input type="text" id="i-dest-ko" value="니시후나바시 行">
        </div>

        <div class="setting-group">
            <label>号車番号 / ナンバリング画像URL</label>
            <input type="text" id="i-car-num" value="1">
            <input type="text" id="i-num" value="https://pipocorp-japan.github.io/asset/Newpipo.jpg">
        </div>

        <div class="btn-row">
            <button class="btn btn-save" onclick="saveCfg()">適用・保存</button>
            <button class="btn btn-close" onclick="closeCfg()">閉じる</button>
        </div>
    </div>

    <script>
        var cube = document.getElementById('cube');
        var step = 0;

        function updateAllTranslations() {
            step++;
            var index = step % 4;
            var angle = step * -90; 
            cube.style.transform = "rotateX(" + angle + "deg)";

            toggleFade('label-container', index);
            toggleFade('dest-container', index);
            toggleFade('type-container', index);
            toggleFade('car-before-container', index);
            toggleFade('car-after-container', index);
        }

        function toggleFade(parentId, index) {
            var items = document.getElementById(parentId).children;
            for(var i=0; i<items.length; i++) {
                items[i].classList.remove('active');
            }
            if(items[index]) items[index].classList.add('active');
        }

        setInterval(updateAllTranslations, 3600);

        function saveCfg() {
            var cfg = {
                jp: document.getElementById('i-jp').value,
                en: document.getElementById('i-en').value,
                zh: document.getElementById('i-zh').value,
                ko: document.getElementById('i-ko').value,
                destJp: document.getElementById('i-dest-jp').value,
                destEn: document.getElementById('i-dest-en').value,
                destZh: document.getElementById('i-dest-zh').value,
                destKo: document.getElementById('i-dest-ko').value,
                carNum: document.getElementById('i-car-num').value,
                num: document.getElementById('i-num').value
            };
            localStorage.setItem('tv_v12_config', JSON.stringify(cfg));
            apply(cfg);
            closeCfg();
        }

        function apply(cfg) {
            document.getElementById('d-jp').innerText = cfg.jp;
            document.getElementById('d-en').innerText = cfg.en;
            document.getElementById('d-zh').innerText = cfg.zh;
            document.getElementById('d-ko').innerText = cfg.ko;

            document.getElementById('d-dest-jp').innerText = cfg.destJp;
            document.getElementById('d-dest-en').innerText = cfg.destEn;
            document.getElementById('d-dest-zh').innerText = cfg.destZh;
            document.getElementById('d-dest-ko').innerText = cfg.destKo;

            document.getElementById('d-car-num').innerText = cfg.carNum;
            document.getElementById('d-num-fixed').src = cfg.num;
        }

        function openCfg() { document.getElementById('cfg-panel').style.display = 'block'; }
        function closeCfg() { document.getElementById('cfg-panel').style.display = 'none'; }

        window.onload = function() {
            var saved = localStorage.getItem('tv_v12_config');
            if(saved) {
                var c = JSON.parse(saved);
                apply(c);
                document.getElementById('i-jp').value = c.jp;
                document.getElementById('i-en').value = c.en;
                document.getElementById('i-zh').value = c.zh;
                document.getElementById('i-ko').value = c.ko;
                document.getElementById('i-dest-jp').value = c.destJp;
                document.getElementById('i-dest-en').value = c.destEn;
                document.getElementById('i-dest-zh').value = c.destZh;
                document.getElementById('i-dest-ko').value = c.destKo;
                document.getElementById('i-car-num').value = c.carNum;
                document.getElementById('i-num').value = c.num;
            }
        };
    </script>
</body>
</html>
